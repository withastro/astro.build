---
import { Image } from 'astro:assets';
import { getEntry, type ReferenceDataEntry } from 'astro:content';
import Card from '~/components/Card.astro';
import { resolveCoverImage } from '~/content/blog/_resolveImage.js';

interface Props {
	entry: ReferenceDataEntry<'blog' | 'caseStudies'>;
}
const { entry } = Astro.props;
const post = await getEntry(entry);

if (!post) {
	throw new Error(
		`Could not find post in the \`${JSON.stringify(entry.collection)}\` collection with slug \`${JSON.stringify(entry.id)}\`.`,
	);
}

const image = await resolveCoverImage(post);
const base = post.collection === 'caseStudies' ? 'case-studies' : 'blog';
---

<Card
	className="relative outline-astro-pink-light transition-transform duration-300 ease-out focus-within:outline hover:scale-[1.03]"
>
	{image && <Image src={image} alt="" width="1000" />}
	<div class="px-4 py-6 flex flex-col gap-4">
		<a
			href={`/${base}/${post.slug}/`}
			class="text-pretty heading-4 md:heading-3 text-white no-underline outline-none after:absolute after:inset-0"
		>
			{post.data.title}
		</a>
		<p>{post.data.description}</p>
	</div>
</Card>
