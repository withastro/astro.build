---
title: 'Astro 5.9'
description: 'Astro v5.9.0 ships with experimental support for Content Security Policy (CSP)'
homepageLink:
  title: 'Astro 5.9'
  subtitle: 'Available now!'
publishDate: '2025-06-05'
authors:
  - ema
coverImage: '/src/content/blog/_images/astro-590/blog-post-5-9.webp'
socialImage: '/src/content/blog/_images/astro-590/og-astro-5-9.webp'
lang: 'en'
---

import Mention from '/src/components/Mention.astro';

**Astro v5.9.0 ships with experimental support for Content Security Policy (CSP)**

## Experimental Content Security Policy

Astro v5.9.0 finally ships experimental, support for Content Security Policy (CSP) of the box.

We designed the feature to work in Astro supported environments (static pages, dynamic pages and single page applications),
have maximum flexibility and type-safety in mind.

You heard that right! You can ditch the unpleasant `unsafe-inline` workaround, use all the Astro features that you like,
install any adapter, and the feature will work.

This is the most upvoted requested feature so far, and we surely took our time to implement. But we hope this is worth the wait!

### The solution

One of the reasons why users like Astro is because it works everywhere (Netlify, Node.js, Cloudflare, Vercel, etc.) with
many frontend libraries (React, Vue, Svelte, etc.). In lue to this spirit, CSP will work everywhere with any library. How?

There are few solutions that web developers can avail to support CSP:
- The use of the [`nonce` header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP#nonces).
- The use of [hashes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP#hashes) generated from the resources shipped to the browser.

While the `nonce` header is very straightforward to implement, it requires a server/edge function that is able to generate
the random value of `nonce`, add the `Content-Security-Policy` header to the `Response` object, and rewrite the HTML to inject the `nonce` value for each `<script>` and `<style>` element.
This solution wouldn't work for websites that aren't served from virtual host e.g. GitHub pages, and it wouldn't work for Single Page Applications (SPA),
where scripts and styles might be injected dynamically during the lifecycle of the application.

The generation of hashes is more complex to implement, however, it can support more use cases than the `nonce` header. Hashes can be provided to the browser via the `Response`
header called `Content-Security-Policy`, or using a `<meta>` element called `http-equiv='content-security-policy'`. The value of this header
is the same for both. As you might have guessed right, using the `Response` header wouldn't work, because it would penalize static websites
and SPA.

Astro will generate the `<meta>` element for you, with all the hashes of the scripts and styles that will be used in the page, *even the ones that will be loaded dynamically*!.

### Usage

First, you have to enable the new experimental flag:

```js title="astro.config.mjs"
import { defineConfig } from "astro/config"

export default defineConfig({
    experimental: {
        csp: true
    }
})
```
You can now use Astro Islands, build your project, and they will work out of the box!

If you use the `Content-Security-Policy` header in your website via middleware or other means, you can still use it, and the browser will use the strictest policy between the header and the `<meta>` element.

However, Astro gives you control over that `<meta>` content via configuration. You can change the default algorithm, insert additional directives, and more:

```js title="astro.config.mjs"
import { defineConfig } from "astro/config"

export default defineConfig({
    experimental: {
        csp: {
            // change the default algorithm
            algorithm: "`SHA-512",
            // insert additional directives
            directives: [
                "default-src: 'self'",
                "image-src: 'https://images.cdn.example.com'"
            ],
            // add more information to the `style-src` directive
            styleDirective: {
                hashes: [
                  "sha384-somehash" // hash generated for some external style e.g. white label, etc.
                ],
                // **Override** default resources
                resources: ["self", "https://styles.cdn.example.com"]
            },

            // add more information to the `style-src` directive
            scriptDirective: {
                hashes: [
                  "sha384-somehash" // hash generated for some external script e.g. analytics, jQuery, etc.
                ],
                // **Override** default resources
                resources: ["self", "https://script.cdn.example.com"],
                // Toggle the keyword `strict-dynamic`
                scriptDynamic: true
            }
        }
    }
})``

```

## Community

The Astro core team is:

<Mention name="ben" />, <Mention name="caleb" />, <Mention name="chris" />, <Mention name="ema" />, <Mention name="erika" />, <Mention name="florian" />, <Mention name="fuzzy" />, <Mention name="hideoo" />, <Mention name="luiz" />, <Mention name="matt" />, <Mention name="matthew" />, <Mention name="nate" />, <Mention name="reuben" />, <Mention name="sarah" />, and <Mention name="yan" />.

import RelatedPosts from './_components/RelatedPosts.astro';

<RelatedPosts slugs={['astro-570', 'astro-560']} />