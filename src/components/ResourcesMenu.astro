---
import ChevronIcon from "~/icons/ChevronIcon.jsx";
import LayersIcon from "~/icons/LayersIcon.jsx";
import OpenBookIcon from "~/icons/OpenBookIcon.jsx";
import PaletteIcon from "~/icons/PaletteIcon.jsx";
---

<details id="resources-menu" class="group relative">
	<summary class="accordion link flex cursor-pointer items-center gap-2">
		Resources
		<span class="sr-only">Open resources menu</span>
		<ChevronIcon
			class="inline-block size-3 rotate-0 transition-transform group-open:-rotate-180 duration-500"
			aria-hidden="true"
		/>
	</summary>
	<ul
		class:list={[
			// flex
			"flex flex-col",

			// positioning
			"absolute left-0 top-full translate-y-2",

			// panel styling
			"min-w-[150px] rounded-xl bg-astro-dark-800 p-1 text-astro-gray-200 shadow-lg border border-astro-dark-100/10",

			// transitioning
			"invisible group-open:visible",
			"origin-top scale-95 group-open:scale-100",
			"opacity-0 group-open:opacity-100",
			"transition-all duration-500",
		]}
	>
		<li>
			<a
				href="/themes/"
				data-astro-prefetch
				class="flex items-center gap-2 rounded-md p-3 leading-none transition hover:bg-astro-dark-700 hover:text-white"
			>
				<PaletteIcon class="h-4 w-4" aria-hidden="true" /> Themes
			</a>
		</li>
		<li>
			<a
				href="/integrations/"
				data-astro-prefetch
				class="flex items-center gap-2 rounded-md p-3 leading-none transition hover:bg-astro-dark-700 hover:text-white"
			>
				<LayersIcon class="h-4 w-4" aria-hidden="true" /> Integrations
			</a>
		</li>
		<li>
			<a
				href="https://docs.astro.build/en/tutorial/0-introduction/"
				class="flex items-center gap-2 rounded-md p-3 leading-none transition hover:bg-astro-dark-700 hover:text-white"
			>
				<OpenBookIcon class="h-4 w-4" aria-hidden="true" /> Tutorials
			</a>
		</li>
	</ul>
</details>

<script>
	const menu = document.querySelector<HTMLDetailsElement>("#resources-menu")!;

	menu.addEventListener("focusout", () => {
		if (!menu.matches(":focus-within")) {
			// delay the transition on focustout so the menu doesn't immediately disappear
			setTimeout(() => {
				menu.open = false;
			}, 200);
		}
	});
</script>
